c1 = as.numeric(str_sub(es.3,
start = str_locate(es.3,"A")[,1] +5,
end = str_locate(es.3,"A")[,1] +5)),
c2 = as.numeric(str_sub(es.3,
start = str_locate(es.3,"A")[,1] +10,
end = str_locate(es.3,"A")[,1] +10)),
c3 = as.numeric(str_sub(es.3,
start = str_locate(es.3,"B")[,1] +5,
end = str_locate(es.3,"B")[,1] +5)),
c4 = as.numeric(str_sub(es.3,
start = str_locate(es.3,"B")[,1] +10,
end = str_locate(es.3,"B")[,1] +10)),
total_sn_dbl_bnds = c1+c2+c3+c4
) %>% #dplyr::select(c(gen.structure,es.1,gs_dbl_bnds,c1,c2,c3,c4)) #%>%
filter(total_sn_dbl_bnds != gs_dbl_bnds) %>%
dplyr::select(gen.structure,total_sn_dbl_bnds)
df %>% filter(grepl("CL",gen.structure)) %>%
mutate(gs_dbl_bnds = as.numeric(str_sub(gen.structure,start = str_locate(gen.structure,":")[,1]+1,end = str_locate(gen.structure,":")[,1]+1)),
c1 = as.numeric(str_sub(es.4,
start = str_locate(es.4,"A")[,1] +5,
end = str_locate(es.4,"A")[,1] +5)),
c2 = as.numeric(str_sub(es.4,
start = str_locate(es.4,"A")[,1] +10,
end = str_locate(es.4,"A")[,1] +10)),
c3 = as.numeric(str_sub(es.4,
start = str_locate(es.4,"B")[,1] +5,
end = str_locate(es.4,"B")[,1] +5)),
c4 = as.numeric(str_sub(es.4,
start = str_locate(es.4,"B")[,1] +10,
end = str_locate(es.4,"B")[,1] +10)),
total_sn_dbl_bnds = c1+c2+c3+c4
) %>% #dplyr::select(c(gen.structure,es.1,gs_dbl_bnds,c1,c2,c3,c4)) #%>%
filter(total_sn_dbl_bnds != gs_dbl_bnds) %>%
dplyr::select(gen.structure,total_sn_dbl_bnds)
df %>% filter(grepl("CL",gen.structure)) %>%
mutate(gs_dbl_bnds = as.numeric(str_sub(gen.structure,start = str_locate(gen.structure,":")[,1]+1,end = str_locate(gen.structure,":")[,1]+1)),
c1 = as.numeric(str_sub(es.5,
start = str_locate(es.5,"A")[,1] +5,
end = str_locate(es.5,"A")[,1] +5)),
c2 = as.numeric(str_sub(es.5,
start = str_locate(es.5,"A")[,1] +10,
end = str_locate(es.5,"A")[,1] +10)),
c3 = as.numeric(str_sub(es.5,
start = str_locate(es.5,"B")[,1] +5,
end = str_locate(es.5,"B")[,1] +5)),
c4 = as.numeric(str_sub(es.5,
start = str_locate(es.5,"B")[,1] +10,
end = str_locate(es.5,"B")[,1] +10)),
total_sn_dbl_bnds = c1+c2+c3+c4
) %>% #dplyr::select(c(gen.structure,es.1,gs_dbl_bnds,c1,c2,c3,c4)) #%>%
filter(total_sn_dbl_bnds != gs_dbl_bnds) %>%
dplyr::select(gen.structure,total_sn_dbl_bnds)
df %>% filter(grepl("CL",gen.structure)) %>%
mutate(gs_dbl_bnds = as.numeric(str_sub(gen.structure,start = str_locate(gen.structure,":")[,1]+1,end = str_locate(gen.structure,":")[,1]+1)),
c1 = as.numeric(str_sub(es.6,
start = str_locate(es.6,"A")[,1] +5,
end = str_locate(es.6,"A")[,1] +5)),
c2 = as.numeric(str_sub(es.6,
start = str_locate(es.6,"A")[,1] +10,
end = str_locate(es.6,"A")[,1] +10)),
c3 = as.numeric(str_sub(es.6,
start = str_locate(es.6,"B")[,1] +5,
end = str_locate(es.6,"B")[,1] +5)),
c4 = as.numeric(str_sub(es.6,
start = str_locate(es.6,"B")[,1] +10,
end = str_locate(es.6,"B")[,1] +10)),
total_sn_dbl_bnds = c1+c2+c3+c4
) %>% #dplyr::select(c(gen.structure,es.1,gs_dbl_bnds,c1,c2,c3,c4)) #%>%
filter(total_sn_dbl_bnds != gs_dbl_bnds) %>%
dplyr::select(gen.structure,total_sn_dbl_bnds)
df %>% filter(grepl("CL",gen.structure)) %>%
mutate(gs_dbl_bnds = as.numeric(str_sub(gen.structure,start = str_locate(gen.structure,":")[,1]+1,end = str_locate(gen.structure,":")[,1]+1)),
c1 = as.numeric(str_sub(es.7,
start = str_locate(es.7,"A")[,1] +5,
end = str_locate(es.7,"A")[,1] +5)),
c2 = as.numeric(str_sub(es.7,
start = str_locate(es.7,"A")[,1] +10,
end = str_locate(es.7,"A")[,1] +10)),
c3 = as.numeric(str_sub(es.7,
start = str_locate(es.7,"B")[,1] +5,
end = str_locate(es.7,"B")[,1] +5)),
c4 = as.numeric(str_sub(es.7,
start = str_locate(es.7,"B")[,1] +10,
end = str_locate(es.7,"B")[,1] +10)),
total_sn_dbl_bnds = c1+c2+c3+c4
) %>% #dplyr::select(c(gen.structure,es.1,gs_dbl_bnds,c1,c2,c3,c4)) #%>%
filter(total_sn_dbl_bnds != gs_dbl_bnds) %>%
dplyr::select(gen.structure,total_sn_dbl_bnds)
shiny::runApp('Desktop/Lodhi lab/PexRAP_data_and_grant/20230105 3t3l1 kd pexrap 13c glucose lipidomics/slat/slat')
library(rsconnect)
rsconnect::setAccountInfo(name='lodhilab', token='669386CBD2A26FFAF0956D25DE22A5ED', secret='6NTSMWIjpOymGrp8hn/Am+gbnRDJWzZ+C9syM85P')
rsconnect::deployApp('/Users/briankleiboeker/Desktop/Lodhi lab/PexRAP_data_and_grant/20230105 3t3l1 kd pexrap 13c glucose lipidomics/slat/slat',account = 'lodhilab')
runApp('Desktop/Lodhi lab/PexRAP_data_and_grant/20230105 3t3l1 kd pexrap 13c glucose lipidomics/shinyapp/structure_from_comp')
library(rsconnect)
rsconnect::setAccountInfo(name='briankleiboeker', token='F659DF4BB6CE768CC7EB6E53272E64C9', secret='ECLyDsv90Prm15BEA/wLGJInXjSsgxU2JUaAQ/6m')
deployApp(appDir = '/Users/briankleiboeker/Desktop/Lodhi lab/PexRAP_data_and_grant/20230105 3t3l1 kd pexrap 13c glucose lipidomics/shinyapp/structure_from_comp',account = 'briankleiboeker')
rsconnect::setAccountInfo(name='briankleiboeker', token='F659DF4BB6CE768CC7EB6E53272E64C9', secret='ECLyDsv90Prm15BEA/wLGJInXjSsgxU2JUaAQ/6m')
deployApp(appDir = '/Users/briankleiboeker/Desktop/Lodhi lab/PexRAP_data_and_grant/20230105 3t3l1 kd pexrap 13c glucose lipidomics/shinyapp/structure_from_comp',account = 'briankleiboeker')
rsconnect::setAccountInfo(name='lodhilab', token='669386CBD2A26FFAF0956D25DE22A5ED', secret='6NTSMWIjpOymGrp8hn/Am+gbnRDJWzZ+C9syM85P')
rsconnect::deployApp('/Users/briankleiboeker/Desktop/Lodhi lab/PexRAP_data_and_grant/20230105 3t3l1 kd pexrap 13c glucose lipidomics/slat/slat',account = 'lodhilab')
knitr::opts_chunk$set(echo = TRUE)
suppressMessages({
library(edgeR)
# library(heatmap3)
library(dplyr)
library(ggplot2)
library(ggrepel)
library(GO.db)
library(org.Mm.eg.db)
library(org.Hs.eg.db)
library(ComplexHeatmap)
# library(IHW)
library(stringr)
# library(tidyr)
# library(rstatix)
# library(RColorBrewer)
})
counts_full<-read.csv('/Users/briankleiboeker/Desktop/Lodhi lab/PexRAP_data_and_grant/Raw RNAseq/all.gene_counts.csv')
#drop all columns except for raw counts by selecting only the columns w/counts
just_counts<-counts_full %>%
dplyr::select("sample.wt_8","sample.wt_7","sample.wt_5","sample.wt_3","sample.wt_2","sample.ko_6","sample.ko_5","sample.ko_3","sample.ko_2","sample.ko_1")
#convert counts into matrix
just_counts<-as.matrix(just_counts)
#name rows of the matrix as ensemblIDs stored in list generic_gene
rownames(just_counts)<- counts_full$ensembl_gene_id
conditions<-c(rep("A",5),rep("B",5))
design <- model.matrix(~conditions)
#set data into DGElist type
d <- DGEList(counts=just_counts,group=factor(conditions),genes=data.frame("ENTREZID"=counts_full$entrezgene,"SYMBOL"=counts_full$external_gene_name))
keep<-filterByExpr(d,design)
d<-d[keep,]
#reset lib sizes after filtering (edgeR user guide and other sources all say to do this)
d$samples$lib.size <- colSums(d$counts)
#find normalization factors
d<-calcNormFactors(d)
#find normalization factors
d<-calcNormFactors(d)
logcpm<-cpm(d,log=TRUE)
cpm_pexrap<-cpm(d,log=T)
#logcpm %>% write.table(.,"/Users/briankleiboeker/Desktop/table.txt")
y <- estimateDisp(d,design,robust = TRUE)
#logcpm %>% write.table(.,"/Users/briankleiboeker/Desktop/table.txt")
y <- estimateDisp(d,design,robust = TRUE)
plotBCV(y)
#get results
fit <- glmQLFit(y,design)
qlf <- glmQLFTest(fit,coef=2)
#store results as toptag_results
toptag_results<-topTags(qlf,n="Inf")$table
toptag_results_pexrap<-topTags(qlf,n="Inf")$table
toptag_results_pexrap<-topTags(qlf,n="Inf")$table
i<-is.na(qlf$genes$ENTREZID)
i<-is.na(qlf$genes$ENTREZID)
j<-qlf$genes$SYMBOL=="Rfc4"|qlf$genes$SYMBOL=="Zfp949"|qlf$genes$SYMBOL=="Dhrs7b"
qlf2<-qlf[!i&!j,]
#write.csv(as.data.frame(topTags(qlf2,n=Inf)) %>% filter(FDR<=0.05),file='/Users/briankleiboeker/Desktop/pexrapgenes.csv',row.names = FALSE)
#perform GO analysis
go<-goana(qlf2,species="Mm",geneid="ENTREZID",plot=TRUE)
topGO(go,n=Inf)
toptag_results %>%
mutate(change=ifelse(PValue<=0.05,ifelse(logFC>0,"Upregulated","Downregulated"),"No_change")) %>%
mutate(SYMBOL=ifelse(SYMBOL=="Dhrs7b","PexRAP",SYMBOL)) %>%
arrange(-FDR) %>%
filter(SYMBOL!="Zfp949") %>%
ggplot(aes(x=logFC,y=-log10(FDR),color=change,label=SYMBOL))+
geom_point(size=0.7)+
theme_bw()+
annotate("text", x = 3.75, y = 0, label = "Upregulated\nin PexRAP-AKO",size=4,color="red")+
annotate("text", x = -3.75, y = 0, label = "Downregulated\nin PexRAP-AKO",size=4,color="blue")+
scale_color_manual(values=c( "blue","gray","red"))+
scale_x_continuous(limits=c(-4.25,4.25))+
labs(color="Fold-change")+
geom_text_repel(data = ~ subset(.x,SYMBOL == "PexRAP" | SYMBOL == "Lpcat3" | SYMBOL == "Acsl3"),
size=3.5,
max.overlaps = Inf,
max.iter = 3e6,
max.time = 20
)+
ggtitle("")+
theme(legend.position = "none")
toptag_results %>%
mutate(change=ifelse(PValue<=0.05,ifelse(logFC>0,"Upregulated","Downregulated"),"No_change")) %>%
mutate(SYMBOL=ifelse(SYMBOL=="Dhrs7b","PexRAP",SYMBOL)) %>%
arrange(-FDR) %>%
filter(SYMBOL!="Zfp949") %>%
ggplot(aes(x=logFC,y=-log10(FDR),color=change,label=SYMBOL))+
geom_point(size=0.7)+
theme_bw()+
annotate("text", x = 3.75, y = 0, label = "Upregulated\nin PexRAP-AKO",size=4,color="red")+
annotate("text", x = -3.75, y = 0, label = "Downregulated\nin PexRAP-AKO",size=4,color="blue")+
scale_color_manual(values=c( "blue","gray","red"))+
scale_x_continuous(limits=c(-4.25,4.25))+
labs(color="Fold-change")+
geom_text_repel(data = ~ subset(.x,SYMBOL == "PexRAP" | SYMBOL == "Lpcat3" | SYMBOL == "Acsl3"),
size=3.5,
max.overlaps = Inf,
max.iter = 3e6,
max.time = 20
)+
ggtitle("")+
theme(legend.position = "none",element_text(size=20))
toptag_results %>%
mutate(change=ifelse(PValue<=0.05,ifelse(logFC>0,"Upregulated","Downregulated"),"No_change")) %>%
mutate(SYMBOL=ifelse(SYMBOL=="Dhrs7b","PexRAP",SYMBOL)) %>%
arrange(-FDR) %>%
filter(SYMBOL!="Zfp949") %>%
ggplot(aes(x=logFC,y=-log10(FDR),color=change,label=SYMBOL))+
geom_point(size=0.7)+
theme_bw()+
annotate("text", x = 3.75, y = 0, label = "Upregulated\nin PexRAP-AKO",size=4,color="red")+
annotate("text", x = -3.75, y = 0, label = "Downregulated\nin PexRAP-AKO",size=4,color="blue")+
scale_color_manual(values=c( "blue","gray","red"))+
scale_x_continuous(limits=c(-4.25,4.25))+
labs(color="Fold-change")+
geom_text_repel(data = ~ subset(.x,SYMBOL == "PexRAP" | SYMBOL == "Lpcat3" | SYMBOL == "Acsl3"),
size=3.5,
max.overlaps = Inf,
max.iter = 3e6,
max.time = 20
)+
ggtitle("")+
theme(legend.position = "none",text = element_text(size=20))
toptag_results %>%
mutate(change=ifelse(PValue<=0.05,ifelse(logFC>0,"Upregulated","Downregulated"),"No_change")) %>%
mutate(SYMBOL=ifelse(SYMBOL=="Dhrs7b","PexRAP",SYMBOL)) %>%
arrange(-FDR) %>%
filter(SYMBOL!="Zfp949") %>%
ggplot(aes(x=logFC,y=-log10(FDR),color=change,label=SYMBOL))+
geom_point(size=0.7)+
theme_bw()+
annotate("text", x = 3.75, y = 0, label = "Upregulated\nin PexRAP-AKO",size=5,color="red")+
annotate("text", x = -3.75, y = 0, label = "Downregulated\nin PexRAP-AKO",size=5,color="blue")+
scale_color_manual(values=c( "blue","gray","red"))+
scale_x_continuous(limits=c(-4.25,4.25))+
labs(color="Fold-change")+
geom_text_repel(data = ~ subset(.x,SYMBOL == "PexRAP" | SYMBOL == "Lpcat3" | SYMBOL == "Acsl3"),
size=5.5,
max.overlaps = Inf,
max.iter = 3e6,
max.time = 20
)+
ggtitle("")+
theme(legend.position = "none",text = element_text(size=20))
library(svglite)
ggsave('/Users/briankleiboeker/Desktop/Lodhi lab/PexRAP_data_and_grant/Paper/fig3a.svg',plot=last_plot(),device="svg")
g<-topGO(go,n=23)
fig3b<-g %>%
filter(!(Term%in%c("secondary alcohol biosynthetic process","sterol biosynthetic process","cholesterol metabolic process","steroid biosynthetic process","sterol metabolic process","alcohol biosynthetic process","secondary alcohol metabolic process","small molecule biosynthetic process","organic hydroxy compound biosynthetic process","steroid metabolic process","alcohol metabolic process","small molecule metabolic process","organic hydroxy compound metabolic process","fatty-acyl-CoA metabolic process","cellular response to sterol depletion"))) %>%
mutate(GeneRatio=(Up+Down)/N) %>%
ggplot(aes(y=reorder(Term,-P.Up),x=-log10(P.Up),color=GeneRatio,size=Up))+
geom_point()+
scale_color_gradient2(low="blue",mid="blue",
high="red", space ="Lab" )+
theme_bw()+
xlab("-log10(p-upregulated)")+
ylab("")+
labs(size="Number of genes\nupregulated",
color="Ratio of genes in\npathway upregulated")+
ggtitle("")+
scale_y_discrete(labels = function(x) str_wrap(str_replace_all(x, "foo" , " "),
width = 17))
fig3b
fig3b<-g %>%
filter(!(Term%in%c("secondary alcohol biosynthetic process","sterol biosynthetic process","cholesterol metabolic process","steroid biosynthetic process","sterol metabolic process","alcohol biosynthetic process","secondary alcohol metabolic process","small molecule biosynthetic process","organic hydroxy compound biosynthetic process","steroid metabolic process","alcohol metabolic process","small molecule metabolic process","organic hydroxy compound metabolic process","fatty-acyl-CoA metabolic process","cellular response to sterol depletion"))) %>%
mutate(GeneRatio=(Up+Down)/N) %>%
ggplot(aes(y=reorder(Term,-P.Up),x=-log10(P.Up),color=GeneRatio,size=Up))+
geom_point()+
scale_color_gradient2(low="blue",mid="blue",
high="red", space ="Lab" )+
theme_bw()+
theme(,text = element_text(size=20))+
xlab("-log10(p-upregulated)")+
ylab("")+
labs(size="Number of genes\nupregulated",
color="Ratio of genes in\npathway upregulated")+
ggtitle("")+
scale_y_discrete(labels = function(x) str_wrap(str_replace_all(x, "foo" , " "),
width = 17))
fig3b
fig3b<-g %>%
filter(!(Term%in%c("secondary alcohol biosynthetic process","sterol biosynthetic process","cholesterol metabolic process","steroid biosynthetic process","sterol metabolic process","alcohol biosynthetic process","secondary alcohol metabolic process","small molecule biosynthetic process","organic hydroxy compound biosynthetic process","steroid metabolic process","alcohol metabolic process","small molecule metabolic process","organic hydroxy compound metabolic process","fatty-acyl-CoA metabolic process","cellular response to sterol depletion"))) %>%
mutate(GeneRatio=(Up+Down)/N) %>%
ggplot(aes(y=reorder(Term,-P.Up),x=-log10(P.Up),color=GeneRatio,size=Up))+
geom_point()+
scale_color_gradient2(low="blue",mid="blue",
high="red", space ="Lab" )+
theme_bw()+
theme(,text = element_text(size=15))+
xlab("-log10(p-upregulated)")+
ylab("")+
labs(size="Number of genes\nupregulated",
color="Ratio of genes in\npathway upregulated")+
ggtitle("")+
scale_y_discrete(labels = function(x) str_wrap(str_replace_all(x, "foo" , " "),
width = 17))
fig3b
ggsave('/Users/briankleiboeker/Desktop/Lodhi lab/PexRAP_data_and_grant/Paper/fig3b.svg',plot=last_plot(),device="svg")
fig3b<-g %>%
filter(!(Term%in%c("secondary alcohol biosynthetic process","sterol biosynthetic process","cholesterol metabolic process","steroid biosynthetic process","sterol metabolic process","alcohol biosynthetic process","secondary alcohol metabolic process","small molecule biosynthetic process","organic hydroxy compound biosynthetic process","steroid metabolic process","alcohol metabolic process","small molecule metabolic process","organic hydroxy compound metabolic process","fatty-acyl-CoA metabolic process","cellular response to sterol depletion"))) %>%
mutate(GeneRatio=(Up+Down)/N) %>%
ggplot(aes(y=reorder(Term,-P.Up),x=-log10(P.Up),color=GeneRatio,size=Up))+
geom_point()+
scale_color_gradient2(low="blue",mid="blue",
high="red", space ="Lab" )+
theme_bw()+
theme(,text = element_text(size=15))+
xlab("-log10(p-upregulated)")+
ylab("")+
labs(size="Number of\ngenes\nupregulated",
color="Ratio of\ngenes in\npathway\nupregulated")+
ggtitle("")+
scale_y_discrete(labels = function(x) str_wrap(str_replace_all(x, "foo" , " "),
width = 17))
fig3b
ggsave('/Users/briankleiboeker/Desktop/Lodhi lab/PexRAP_data_and_grant/Paper/fig3b.svg',plot=last_plot(),device="svg")
fig3b<-g %>%
filter(!(Term%in%c("secondary alcohol biosynthetic process","sterol biosynthetic process","cholesterol metabolic process","steroid biosynthetic process","sterol metabolic process","alcohol biosynthetic process","secondary alcohol metabolic process","small molecule biosynthetic process","organic hydroxy compound biosynthetic process","steroid metabolic process","alcohol metabolic process","small molecule metabolic process","organic hydroxy compound metabolic process","fatty-acyl-CoA metabolic process","cellular response to sterol depletion"))) %>%
mutate(GeneRatio=(Up+Down)/N) %>%
ggplot(aes(y=reorder(Term,-P.Up),x=-log10(P.Up),color=GeneRatio,size=Up))+
geom_point()+
scale_color_gradient2(low="blue",mid="blue",
high="red", space ="Lab" )+
theme_bw()+
theme(text = element_text(size=17))+
xlab("-log10(p-upregulated)")+
ylab("")+
labs(size="Number of\ngenes\nupregulated",
color="Ratio of\ngenes in\npathway\nupregulated")+
ggtitle("")+
scale_y_discrete(labels = function(x) str_wrap(str_replace_all(x, "foo" , " "),
width = 17))
fig3b
ggsave('/Users/briankleiboeker/Desktop/Lodhi lab/PexRAP_data_and_grant/Paper/fig3b.svg',plot=last_plot(),device="svg")
zscores<-as.data.frame(t(scale(t(logcpm[rownames(logcpm)%in%rownames(toptag_results %>%
filter(PValue<=0.01)),]))))
rownames(zscores)<-NULL
#png(file="/Users/briankleiboeker/Desktop/Lodhi lab/PexRAP_data_and_grant/Paper/fullheatmap11111.png",width=1500,height=1500,res = 200)
#svglite(filename= "/Users/briankleiboeker/Desktop/Lodhi lab/PexRAP_data_and_grant/Paper/fullheatmap11111.svg",width = 8, height =8)
Heatmap(as.matrix(zscores),cluster_columns = T,show_row_dend = F, name="Z-score",column_split = c(rep("WT",5),rep("AKO",5)), column_gap = unit(0,"mm"),show_parent_dend_line = F,column_labels = c(paste0(rep("Control_"),1:5),paste0(rep("PexRAP_AKO_"),1:5)),   column_names_gp = grid::gpar(fontsize = 15), column_title=" ")
zscores<-as.data.frame(t(scale(t(logcpm[rownames(logcpm)%in%rownames(toptag_results %>%
filter(PValue<=0.01)),]))))
rownames(zscores)<-NULL
#png(file="/Users/briankleiboeker/Desktop/Lodhi lab/PexRAP_data_and_grant/Paper/fullheatmap11111.png",width=1500,height=1500,res = 200)
#svglite(filename= "/Users/briankleiboeker/Desktop/Lodhi lab/PexRAP_data_and_grant/Paper/fullheatmap11111.svg",width = 8, height =8)
Heatmap(as.matrix(zscores),cluster_columns = T,show_row_dend = F, name="Z-score",column_split = c(rep("WT",5),rep("AKO",5)), column_gap = unit(0,"mm"),show_parent_dend_line = F,column_labels = c(paste0(rep("Control_"),1:5),paste0(rep("PexRAP_AKO_"),1:5)),   column_names_gp = grid::gpar(fontsize = 15), column_title=" ")
#dev.off()
h<-Heatmap(as.matrix(zscores),cluster_columns = T,show_row_dend = F, name="Z-score",column_split = c(rep("WT",5),rep("AKO",5)), column_gap = unit(0,"mm"),show_parent_dend_line = F,column_labels = c(paste0(rep("Control_"),1:5),paste0(rep("PexRAP_AKO_"),1:5)),   column_names_gp = grid::gpar(fontsize = 15), column_title=" ")
draw(h,heatmap_legend_side = "top")
h<-Heatmap(as.matrix(zscores),
cluster_columns = T,
show_row_dend = F,
name="Z-score",
column_split = c(rep("WT",5),rep("AKO",5)),
column_gap = unit(0,"mm"),
show_parent_dend_line = F,
column_labels = c(paste0(rep("Control_"),1:5),paste0(rep("PexRAP_AKO_"),1:5)),
column_names_gp = grid::gpar(fontsize = 15),
column_title=" ",
heatmap_legend_param = list(
direction="horizontal",
title_position = "topcenter"))
draw(h,heatmap_legend_side = "top")
zscores<-as.data.frame(t(scale(t(logcpm[rownames(logcpm)%in%rownames(toptag_results %>%
filter(PValue<=0.01)),]))))
rownames(zscores)<-NULL
#png(file="/Users/briankleiboeker/Desktop/Lodhi lab/PexRAP_data_and_grant/Paper/fullheatmap11111.png",width=1500,height=1500,res = 200)
svglite(filename= "/Users/briankleiboeker/Desktop/Lodhi lab/PexRAP_data_and_grant/Paper/fullheatmap_apr23.svg",width = 6, height =8)
h<-Heatmap(as.matrix(zscores),
cluster_columns = T,
show_row_dend = F,
name="Z-score",
column_split = c(rep("WT",5),rep("AKO",5)),
column_gap = unit(0,"mm"),
show_parent_dend_line = F,
column_labels = c(paste0(rep("Control_"),1:5),paste0(rep("PexRAP_AKO_"),1:5)),
column_names_gp = grid::gpar(fontsize = 15),
column_title=" ",
heatmap_legend_param = list(
direction="horizontal",
title_position = "topcenter"))
draw(h,heatmap_legend_side = "top")
dev.off()
fig3b<-g %>%
filter(!(Term%in%c("secondary alcohol biosynthetic process","sterol biosynthetic process","cholesterol metabolic process","steroid biosynthetic process","sterol metabolic process","alcohol biosynthetic process","secondary alcohol metabolic process","small molecule biosynthetic process","organic hydroxy compound biosynthetic process","steroid metabolic process","alcohol metabolic process","small molecule metabolic process","organic hydroxy compound metabolic process","fatty-acyl-CoA metabolic process","cellular response to sterol depletion"))) %>%
mutate(GeneRatio=(Up+Down)/N) %>%
ggplot(aes(y=reorder(Term,-P.Up),x=-log10(P.Up),color=GeneRatio,size=Up))+
geom_point()+
scale_color_gradient2(low="blue",mid="blue",
high="red", space ="Lab" )+
theme_bw()+
theme(text = element_text(size=17))+
xlab("-log10(p-upregulated)")+
ylab("")+
labs(size="Number of\ngenes\nupregulated",
color="Ratio of\ngenes in\npathway\nupregulated")+
ggtitle("")+
scale_y_discrete(labels = function(x) str_wrap(str_replace_all(x, "foo" , " "),
width = 14))
fig3b
fig3b<-g %>%
filter(!(Term%in%c("secondary alcohol biosynthetic process","sterol biosynthetic process","cholesterol metabolic process","steroid biosynthetic process","sterol metabolic process","alcohol biosynthetic process","secondary alcohol metabolic process","small molecule biosynthetic process","organic hydroxy compound biosynthetic process","steroid metabolic process","alcohol metabolic process","small molecule metabolic process","organic hydroxy compound metabolic process","fatty-acyl-CoA metabolic process","cellular response to sterol depletion"))) %>%
mutate(GeneRatio=(Up+Down)/N) %>%
ggplot(aes(y=reorder(Term,-P.Up),x=-log10(P.Up),color=GeneRatio,size=Up))+
geom_point()+
scale_color_gradient2(low="blue",mid="blue",
high="red", space ="Lab" )+
theme_bw()+
theme(text = element_text(size=17))+
xlab("-log10(p-upregulated)")+
ylab("")+
labs(size="Number of\ngenes\nupregulated",
color="Ratio of\ngenes in\npathway\nupregulated")+
ggtitle("")+
scale_y_discrete(labels = function(x) str_wrap(str_replace_all(x, "foo" , " "),
width = 13))
fig3b
ggsave('/Users/briankleiboeker/Desktop/Lodhi lab/PexRAP_data_and_grant/Paper/fig3b.svg',plot=last_plot(),device="svg")
ggsave('/Users/briankleiboeker/Desktop/Lodhi lab/PexRAP_data_and_grant/Paper/fig3b.svg',plot=last_plot(),device="svg",height = 7, width = 6.5)
devtools::install_github("briankleiboeker/slatR")
?slatR
??slatR
devtools::install_github("briankleiboeker/slatR")
devtools::install_github("briankleiboeker/slatR")
library(slatR)
df<-read.csv('/Users/briankleiboeker/Desktop/testdata.csv')
df
head(df)
extract_num_elements("C",df$Composition)
?extract_num_elements
library(slatR)
df<-read.csv('/Users/briankleiboeker/Desktop/testdata.csv')
df
( "23" - (4/2) + ((4+1)/2) +1 )
a<-( "23" - (4/2) + ((4+1)/2) +1 )
a
is.na(a)
read.csv('/Users/briankleiboeker/Desktop/testdata.csv')
df<-read.csv('/Users/briankleiboeker/Desktop/testdata.csv')
head(df)
is.numeric(df$Intensity)
df$testcol <- NULL
head(df)
length("pos.ion")
length(14)
devtools::install_github("briankleiboeker/slatR")
devtools::install_github("briankleiboeker/slatR", force = T)
library(slatR)
?slatR
?extract_num_elements
?assign_structures
devtools::install_github("briankleiboeker/slatR", force = T)
library(slatR)
?assign_structures
devtools::install_github('briankleiboeker/slatR',force = T)
library(slatR)
?assign_structure
?extract_num_elements
devtools::install_github('briankleiboeker/slatR',force = T)
library(slatR)
?extract_num_elements
devtools::install_github("briankleiboeker/slatR")
library(slatR)
?assign_structures
help
ls
getwd()
setwd()
1+1
?extract_num_elements
devtools::install_github('briankleiboeker/slatR')
library(slatR)
library(slatR)
assign_structures()
df<-read.csv('/Users/briankleiboeker/Desktop/testdata.csv')
df$c<-extract_num_elements("C",df$Composition)
head(df)
df$h<-extract_num_elements("H",df$Composition)
df$o<-extract_num_elements("O",df$Composition)
df$n<-extract_num_elements("N",df$Composition)
df$p<-extract_num_elements("P",df$Composition)
df$na<-extract_num_elements("Na",df$Composition)
df$cl<-extract_num_elements("Cl",df$Composition)
head(df)
assign_structures(df$c,df$h,df$o,df$n,df$p,df$na,df$cl,"neg.ion",domain = "euk")
df$structure<-assign_structures(df$c,df$h,df$o,df$n,df$p,df$na,df$cl,"neg.ion",domain = "euk")
head(df)
read.csv('/Users/briankleiboeker/Desktop/Lodhi lab/PexRAP_data_and_grant/20230105 3t3l1 kd pexrap 13c glucose lipidomics/shinyapp/structure_from_comp/pl_database.csv')
read.csv('/Users/briankleiboeker/Desktop/Lodhi lab/PexRAP_data_and_grant/20230105 3t3l1 kd pexrap 13c glucose lipidomics/shinyapp/structure_from_comp/pl_database.csv')
df<-read.csv('/Users/briankleiboeker/Desktop/Lodhi lab/PexRAP_data_and_grant/20230105 3t3l1 kd pexrap 13c glucose lipidomics/shinyapp/structure_from_comp/pl_database.csv')
head(df)
setwd('/Users/briankleiboeker/Desktop/Lodhi lab/PexRAP_data_and_grant/20230105 3t3l1 kd pexrap 13c glucose lipidomics/slatR')
usethis::use_data(df,internal = T)
pl_database <- df
head(pl_database)
usethis::use_data(pl_database,internal = T)
read.csv('/Users/briankleiboeker/Desktop/testdata.csv')
df<-read.csv('/Users/briankleiboeker/Desktop/testdata.csv')
df
df
df$Composition
as.data.frame(df$Composition)
head(as.data.frame(df$Composition))
head(as.data.frame("composition" = df$Composition))
head(data.frame("composition" = df$Composition))
df<-(data.frame("composition" = df$Composition))
head(df)
df<-read.csv('/Users/briankleiboeker/Desktop/testdata.csv')
df2<-df
cbind(df,df2)
head(cbind(df,df2))
setwd('/Users/briankleiboeker/Desktop/Lodhi lab/PexRAP_data_and_grant/20230105 3t3l1 kd pexrap 13c glucose lipidomics/slatR')
devtools::document()
